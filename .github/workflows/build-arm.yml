name: Rust

on:
    push:
        branches: ["main"]
    pull_request:
        branches: ["main"]
    workflow_dispatch:

env:
    CARGO_TERM_COLOR: always

jobs:
    pleasebuild:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v3

            - name: Cache dependencies
              uses: actions/cache@v3
              with:
                  path: ~/build
                  key: src-4.7.0-ubuntu-latest

            - name: Install dependencies
              run: ci/install.sh
              shell: bash

            - name: Install Rust
              uses: dtolnay/rust-toolchain@stable

            - name: Build project
              run: ci/run.sh
              shell: bash
